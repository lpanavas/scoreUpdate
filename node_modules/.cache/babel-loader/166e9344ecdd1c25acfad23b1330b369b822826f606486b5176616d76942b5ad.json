{"ast":null,"code":"import _slicedToArray from\"C:/Users/lpana/OneDrive/Documents/gameIterations/scoreUpdate/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useRef,useState}from\"react\";import*as d3 from\"d3\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var data={0:{low_score:0,average_score:0,high_score:49},1:{low_score:0,average_score:19,high_score:49},2:{low_score:0,average_score:38,high_score:98},3:{low_score:0,average_score:55,high_score:147},4:{low_score:0,average_score:70,high_score:179},5:{low_score:0,average_score:85,high_score:228},6:{low_score:0,average_score:102,high_score:272}};var maxHighScore=102;// Game finishes when the score reaches 102\nfunction TwoScoreLine(_ref){var userScore=_ref.userScore,stage=_ref.stage,onFinish=_ref.onFinish;var ref=useRef();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),finishedGame=_useState2[0],setFinishedGame=_useState2[1];var _useState3=useState(userScore),_useState4=_slicedToArray(_useState3,2),previousScore=_useState4[0],setPreviousScore=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),scoreChangeMsg=_useState6[0],setScoreChangeMsg=_useState6[1];// New state variable\nuseEffect(function(){if(userScore!==previousScore){var diff=userScore-previousScore;setScoreChangeMsg(\"You agree with \".concat(100-diff,\"%. Your score increased by 100 - \").concat(100-diff,\" = \").concat(diff));setPreviousScore(userScore);}},[userScore]);useEffect(function(){var svg=d3.select(ref.current);var svgWidth=+svg.node().getBoundingClientRect().width;var xScale=d3.scaleLinear().domain([0,maxHighScore]).range([0,svgWidth]);var score=data[stage];// Background lines and labels\nvar lineInfo=[{y:100,class:\"user\",color:\"green\",label:\"You\",score:userScore},{y:170,class:\"avg\",color:\"black\",label:\"Others\",score:score.average_score}];lineInfo.forEach(function(line){if(svg.select(\".\".concat(line.class,\"-bg-line\")).empty()){// Background line\nsvg.append(\"line\").attr(\"class\",\"\".concat(line.class,\"-bg-line\")).attr(\"x1\",xScale(0)).attr(\"x2\",xScale(maxHighScore)).attr(\"y1\",line.y).attr(\"y2\",line.y).attr(\"stroke\",\"#ddd\").attr(\"stroke-width\",2);// Label\nsvg.append(\"text\").attr(\"class\",\"\".concat(line.class,\"-label\")).attr(\"x\",0).attr(\"y\",line.y).attr(\"dy\",\"-1em\").text(line.label);// Tick mark\nsvg.append(\"circle\").attr(\"class\",\"\".concat(line.class,\"-tick\")).attr(\"cx\",xScale(line.score)).attr(\"cy\",line.y).attr(\"r\",5).attr(\"fill\",line.color);// Tick text\nsvg.append(\"text\").attr(\"class\",\"\".concat(line.class,\"-tick-text\")).attr(\"x\",xScale(line.score)).attr(\"y\",line.y).attr(\"dx\",\"1em\").attr(\"dy\",\"1em\").text(line.score);}});// Update elements\nsvg.selectAll(\".user-tick\").data([userScore]).transition().duration(1000).attr(\"cx\",function(d){return xScale(Math.min(d,maxHighScore));});svg.selectAll(\".avg-tick\").data([score.average_score]).transition().duration(1000).attr(\"cx\",function(d){return xScale(Math.min(d,maxHighScore));});svg.selectAll(\".user-tick-text\").data([userScore]).transition().duration(1000).attr(\"x\",function(d){return xScale(Math.min(d,maxHighScore));}).text(function(d){return d;});svg.selectAll(\".avg-tick-text\").data([score.average_score]).transition().duration(1000).attr(\"x\",function(d){return xScale(Math.min(d,maxHighScore));}).text(function(d){return d;});// Check if game is finished\nif((userScore>=maxHighScore||score.average_score>=maxHighScore)&&!finishedGame){setFinishedGame(true);onFinish===null||onFinish===void 0?void 0:onFinish();}},[userScore,stage,finishedGame,onFinish]);return/*#__PURE__*/_jsxs(\"div\",{className:\"scoreLines\",children:[scoreChangeMsg&&/*#__PURE__*/_jsx(\"div\",{children:scoreChangeMsg}),/*#__PURE__*/_jsx(\"svg\",{ref:ref,style:{width:\"100%\",height:\"200px\"}})]});}export default TwoScoreLine;","map":{"version":3,"names":["React","useEffect","useRef","useState","d3","jsx","_jsx","jsxs","_jsxs","data","low_score","average_score","high_score","maxHighScore","TwoScoreLine","_ref","userScore","stage","onFinish","ref","_useState","_useState2","_slicedToArray","finishedGame","setFinishedGame","_useState3","_useState4","previousScore","setPreviousScore","_useState5","_useState6","scoreChangeMsg","setScoreChangeMsg","diff","concat","svg","select","current","svgWidth","node","getBoundingClientRect","width","xScale","scaleLinear","domain","range","score","lineInfo","y","class","color","label","forEach","line","empty","append","attr","text","selectAll","transition","duration","d","Math","min","className","children","style","height"],"sources":["C:/Users/lpana/OneDrive/Documents/gameIterations/scoreUpdate/src/components/TwoScoreLine.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\r\nimport * as d3 from \"d3\";\r\n\r\nconst data = {\r\n  0: { low_score: 0, average_score: 0, high_score: 49 },\r\n  1: { low_score: 0, average_score: 19, high_score: 49 },\r\n  2: { low_score: 0, average_score: 38, high_score: 98 },\r\n  3: { low_score: 0, average_score: 55, high_score: 147 },\r\n  4: { low_score: 0, average_score: 70, high_score: 179 },\r\n  5: { low_score: 0, average_score: 85, high_score: 228 },\r\n  6: { low_score: 0, average_score: 102, high_score: 272 },\r\n};\r\n\r\nconst maxHighScore = 102; // Game finishes when the score reaches 102\r\n\r\nfunction TwoScoreLine({ userScore, stage, onFinish }) {\r\n  const ref = useRef();\r\n  const [finishedGame, setFinishedGame] = useState(false);\r\n  const [previousScore, setPreviousScore] = useState(userScore);\r\n  const [scoreChangeMsg, setScoreChangeMsg] = useState(null); // New state variable\r\n\r\n  useEffect(() => {\r\n    if (userScore !== previousScore) {\r\n      const diff = userScore - previousScore;\r\n      setScoreChangeMsg(\r\n        `You agree with ${100 - diff}%. Your score increased by 100 - ${\r\n          100 - diff\r\n        } = ${diff}`\r\n      );\r\n      setPreviousScore(userScore);\r\n    }\r\n  }, [userScore]);\r\n\r\n  useEffect(() => {\r\n    const svg = d3.select(ref.current);\r\n    const svgWidth = +svg.node().getBoundingClientRect().width;\r\n    const xScale = d3\r\n      .scaleLinear()\r\n      .domain([0, maxHighScore])\r\n      .range([0, svgWidth]);\r\n    const score = data[stage];\r\n\r\n    // Background lines and labels\r\n    const lineInfo = [\r\n      { y: 100, class: \"user\", color: \"green\", label: \"You\", score: userScore },\r\n      {\r\n        y: 170,\r\n        class: \"avg\",\r\n        color: \"black\",\r\n        label: \"Others\",\r\n        score: score.average_score,\r\n      },\r\n    ];\r\n\r\n    lineInfo.forEach((line) => {\r\n      if (svg.select(`.${line.class}-bg-line`).empty()) {\r\n        // Background line\r\n        svg\r\n          .append(\"line\")\r\n          .attr(\"class\", `${line.class}-bg-line`)\r\n          .attr(\"x1\", xScale(0))\r\n          .attr(\"x2\", xScale(maxHighScore))\r\n          .attr(\"y1\", line.y)\r\n          .attr(\"y2\", line.y)\r\n          .attr(\"stroke\", \"#ddd\")\r\n          .attr(\"stroke-width\", 2);\r\n\r\n        // Label\r\n        svg\r\n          .append(\"text\")\r\n          .attr(\"class\", `${line.class}-label`)\r\n          .attr(\"x\", 0)\r\n          .attr(\"y\", line.y)\r\n          .attr(\"dy\", \"-1em\")\r\n          .text(line.label);\r\n\r\n        // Tick mark\r\n        svg\r\n          .append(\"circle\")\r\n          .attr(\"class\", `${line.class}-tick`)\r\n          .attr(\"cx\", xScale(line.score))\r\n          .attr(\"cy\", line.y)\r\n          .attr(\"r\", 5)\r\n          .attr(\"fill\", line.color);\r\n\r\n        // Tick text\r\n        svg\r\n          .append(\"text\")\r\n          .attr(\"class\", `${line.class}-tick-text`)\r\n          .attr(\"x\", xScale(line.score))\r\n          .attr(\"y\", line.y)\r\n          .attr(\"dx\", \"1em\")\r\n          .attr(\"dy\", \"1em\")\r\n          .text(line.score);\r\n      }\r\n    });\r\n\r\n    // Update elements\r\n    svg\r\n      .selectAll(\".user-tick\")\r\n      .data([userScore])\r\n      .transition()\r\n      .duration(1000)\r\n      .attr(\"cx\", (d) => xScale(Math.min(d, maxHighScore)));\r\n\r\n    svg\r\n      .selectAll(\".avg-tick\")\r\n      .data([score.average_score])\r\n      .transition()\r\n      .duration(1000)\r\n      .attr(\"cx\", (d) => xScale(Math.min(d, maxHighScore)));\r\n\r\n    svg\r\n      .selectAll(\".user-tick-text\")\r\n      .data([userScore])\r\n      .transition()\r\n      .duration(1000)\r\n      .attr(\"x\", (d) => xScale(Math.min(d, maxHighScore)))\r\n      .text((d) => d);\r\n\r\n    svg\r\n      .selectAll(\".avg-tick-text\")\r\n      .data([score.average_score])\r\n      .transition()\r\n      .duration(1000)\r\n      .attr(\"x\", (d) => xScale(Math.min(d, maxHighScore)))\r\n      .text((d) => d);\r\n\r\n    // Check if game is finished\r\n    if (\r\n      (userScore >= maxHighScore || score.average_score >= maxHighScore) &&\r\n      !finishedGame\r\n    ) {\r\n      setFinishedGame(true);\r\n      onFinish?.();\r\n    }\r\n  }, [userScore, stage, finishedGame, onFinish]);\r\n\r\n  return (\r\n    <div className=\"scoreLines\">\r\n      {scoreChangeMsg && <div>{scoreChangeMsg}</div>}\r\n      <svg ref={ref} style={{ width: \"100%\", height: \"200px\" }} />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default TwoScoreLine;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}